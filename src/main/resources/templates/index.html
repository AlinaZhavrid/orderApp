<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Order App CRUD Test</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <style>
        body { font-family: Arial; margin: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        button { margin: 5px; }
    </style>
</head>
<body>
<h1>Order Management</h1>

<div>
    <h2>Create Order</h2>
    <input id="desc" type="text" placeholder="Description">
    <input id="amount" type="number" placeholder="Amount">
    <button onclick="createOrder()">Create</button>
</div>

<div>
    <h2>Orders List</h2>
    <button onclick="loadOrders()">Refresh</button>
    <table id="ordersTable">
        <thead>
        <tr>
            <th>ID</th>
            <th>Description</th>
            <th>Amount</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    const API_URL = "http://localhost:8080/orders";

    // Загрузить все заказы
    async function loadOrders() {
        const response = await axios.get(API_URL);
        const tableBody = document.querySelector("#ordersTable tbody");
        tableBody.innerHTML = response.data.map(order => `
            <tr>
                <td>${order.id}</td>
                <td>${order.description}</td>
                <td>${order.amount}</td>
                <td>
                    <button onclick="deleteOrder('${order.id}')">Delete</button>
                </td>
            </tr>
        `).join('');
    }

    // Создать новый заказ
    async function createOrder() {
        const desc = document.getElementById("desc").value;
        const amount = parseFloat(document.getElementById("amount").value);

        await axios.post(API_URL, {
            description: desc,
            amount: amount
        });

        loadOrders();
    }

    // Удалить заказ
    async function deleteOrder(id) {
        await axios.delete(`${API_URL}/${id}`);
        loadOrders();
    }

    // Загрузить данные при старте
    loadOrders();
</script>
</body>
</html>